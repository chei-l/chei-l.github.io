---
title: "ë³‘ì›ê²Œì„"
date: "2025-05-25"
author: "chei"
---

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê·€ì—¬ìš´ ë³‘ì› ê²Œì„</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.min.js"></script>
    <style>
        /* ê¸°ë³¸ í°íŠ¸ ì„¤ì • ë° ë°°ê²½ìƒ‰ */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #fce4ec; /* ì—°í•œ í•‘í¬ ë°°ê²½ */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }

        /* ë§í’ì„  ê¼¬ë¦¬ ë¶€ë¶„ì€ Tailwindë¡œ ì§ì ‘ êµ¬í˜„í•˜ê¸° ì–´ë ¤ì›Œ ì»¤ìŠ¤í…€ CSS ìœ ì§€ */
        .message-box::after {
            content: '';
            position: absolute;
            bottom: -15px; /* ë°•ìŠ¤ ì•„ë˜ì— ìœ„ì¹˜ */
            left: 50%;
            transform: translateX(-50%) rotate(45deg);
            width: 20px;
            height: 20px;
            background-color: #fff; /* ê¸°ë³¸ ë§í’ì„  ë°°ê²½ìƒ‰ê³¼ ë™ì¼ */
            border-right: 2px solid #f8bbd0; /* ê¸°ë³¸ ë§í’ì„  í…Œë‘ë¦¬ìƒ‰ê³¼ ë™ì¼ */
            border-bottom: 2px solid #f8bbd0; /* ê¸°ë³¸ ë§í’ì„  í…Œë‘ë¦¬ìƒ‰ê³¼ ë™ì¼ */
            z-index: -1; /* ë°•ìŠ¤ ë’¤ë¡œ ë³´ë‚´ê¸° */
        }

        /* ë©”ì‹œì§€ íƒ€ì…ë³„ ë§í’ì„  ê¼¬ë¦¬ ìƒ‰ìƒ */
        .message-box.type-green::after {
            background-color: #e8f5e9;
            border-color: #a5d6a7;
        }
        .message-box.type-red::after {
            background-color: #ffebee;
            border-color: #ef9a9a;
        }
        .message-box.type-orange::after {
            background-color: #fff3e0;
            border-color: #ffcc80;
        }

        /* ë¶€ìƒ ë¶€ìœ„ ê¹œë¹¡ì´ëŠ” ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes pulse {
            from { transform: scale(1); opacity: 1; }
            to { transform: scale(1.1); opacity: 0.8; }
        }
        .injury-spot {
            animation: pulse 1.5s infinite alternate; /* ê¹œë¹¡ì´ëŠ” ì• ë‹ˆë©”ì´ì…˜ */
        }

        /* ìƒˆë¡œìš´ ì´ëª¨ì§€ ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes bounce-emoji {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-10px) scale(1.1); }
        }
        .animate-bounce-emoji {
            animation: bounce-emoji 0.5s ease-out;
        }

        @keyframes shake-emoji {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-5px); }
            40%, 80% { transform: translateX(5px); }
        }
        .animate-shake-emoji {
            animation: shake-emoji 0.3s ease-in-out;
        }

        /* ë¶€ìƒ ë¶€ìœ„ íŒ ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes pop-injury {
            0% { transform: scale(1); opacity: 1; background-color: rgba(255, 0, 0, 0.3); }
            50% { transform: scale(1.3); opacity: 1; background-color: rgba(255, 0, 0, 0.8); } /* ë” ë°ì€ ë¹¨ê°„ìƒ‰ */
            100% { transform: scale(1); opacity: 1; background-color: rgba(255, 0, 0, 0.3); }
        }
        .animate-pop-injury {
            animation: pop-injury 0.3s ease-out; /* ë¹ ë¥¸ íŒ íš¨ê³¼ */
        }

        /* ë°˜ì‘í˜• ë””ìì¸ */
        @media (max-width: 768px) {
            .message-box {
                top: 2% !important; /* ëª¨ë°”ì¼ì—ì„œ ìœ„ìª½ìœ¼ë¡œ ì¡°ê¸ˆ ë” ì˜¬ë¦¼ */
            }
            .message-box::after {
                bottom: -10px; /* ê¼¬ë¦¬ í¬ê¸° ì¡°ì • */
                width: 15px;
                height: 15px;
            }
        }
    </style>
</head>
<body class="flex justify-center items-center min-h-screen p-5 bg-pink-100">
    <div class="game-container bg-white rounded-3xl shadow-xl p-8 flex flex-col items-center gap-6 max-w-3xl w-full">
        <h1 class="text-4xl font-bold text-pink-700 mb-6">ğŸ¥ ê·€ì—¬ìš´ ë³‘ì› ê²Œì„ ğŸ¥</h1>

        <div class="score-board bg-blue-100 py-4 px-8 rounded-xl text-xl font-bold text-blue-800 mt-4">
            ì¹˜ë£Œí•œ í™˜ì ìˆ˜: <span id="treatedPatientsCount">0</span>ëª…
        </div>

        <div class="tools-container flex flex-wrap justify-center gap-4 mb-6" id="toolsContainer">
            </div>

        <div class="patient-area bg-pink-50 rounded-2xl p-10 flex flex-col items-center justify-center min-h-72 w-full max-w-xl relative overflow-hidden" id="patientArea">
            <div class="message-box bg-white text-gray-800 p-4 rounded-3xl text-xl font-bold text-center min-h-16 flex items-center justify-center w-fit max-w-sm shadow-sm absolute top-5 left-1/2 -translate-x-1/2 z-30 border-2 border-pink-200" id="messageBox">
                í™˜ìë¥¼ ì¹˜ë£Œí•´ ì£¼ì„¸ìš”!
            </div>
            <div class="patient-emoji text-9xl mb-5 relative z-10" id="patientEmoji"></div>
            <div class="injury-spot hidden bg-red-300/50 rounded-full w-20 h-20 absolute cursor-pointer flex justify-center items-center text-5xl z-20" id="injurySpot"></div>
            <div class="waiting-message hidden text-3xl font-bold text-purple-700 text-center mt-5" id="waitingMessage">ìƒˆë¡œìš´ í™˜ìê°€ ì˜¤ê³  ìˆì–´ìš”!</div>
        </div>
    </div>

    <script>
        // ê²Œì„ì— ì‚¬ìš©ë  ë„êµ¬ë“¤ ì •ë³´
        const tools = [
            { name: 'ë°´ë“œ', icon: 'ğŸ©¹', correctFor: 'ìƒì²˜' },
            { name: 'í•€ì…‹', icon: 'ğŸ¤', correctFor: 'ê°€ì‹œ' },
            { name: 'ì£¼ì‚¬ê¸°', icon: 'ğŸ’‰', correctFor: 'ë…ê°' },
            { name: 'ë¶•ëŒ€', icon: 'ğŸ¤•', correctFor: 'ê³¨ì ˆ' },
            { name: 'ì•½', icon: 'ğŸ’Š', correctFor: 'ë‘í†µ' },
            { name: 'ì†œ', icon: 'â˜ï¸', correctFor: 'ë²Œë ˆë¬¼ë¦¼' },
            { name: 'ì–¼ìŒì°œì§ˆ', icon: 'ğŸ§Š', correctFor: 'ë©' },
            { name: 'ì•ˆì•½', icon: 'ğŸ‘ï¸', correctFor: 'ëˆˆë³‘' },
            { name: 'í™”ìƒì—°ê³ ', icon: 'ğŸ§´', correctFor: 'í™”ìƒ' }, // ìƒˆë¡œìš´ ë„êµ¬
            { name: 'íŒŒìŠ¤', icon: 'ğŸ©¹', correctFor: 'ë°œëª©ì‚ë—' }, // ìƒˆë¡œìš´ ë„êµ¬
            { name: 'ìŒì‹', icon: 'ğŸ”', correctFor: 'ë°°ê³ í””' }, // ìƒˆë¡œìš´ ë„êµ¬
            { name: 'ë² ê°œ', icon: 'ğŸ›Œ', correctFor: 'ì¡¸ë¦¼' }, // ìƒˆë¡œìš´ ë„êµ¬
            { name: 'ë¹„íƒ€ë¯¼', icon: 'ğŸŠ', correctFor: 'í”¼ê³¤í•¨' }, // ìƒˆë¡œìš´ ë„êµ¬
            { name: 'ë¬¼', icon: 'ğŸ’§', correctFor: 'ë”¸ê¾¹ì§ˆ' }, // ìƒˆë¡œìš´ ë„êµ¬
            { name: 'ì—°ê³ ', icon: 'ğŸ§´', correctFor: 'í”¼ë¶€ê°€ë ¤ì›€' }, // ìƒˆë¡œìš´ ë„êµ¬
            { name: 'ë©€ë¯¸ì•½', icon: 'ğŸ¤¢', correctFor: 'ë©€ë¯¸' } // ìƒˆë¡œìš´ ë„êµ¬
        ];

        // ê²Œì„ì— ì‚¬ìš©ë  í™˜ìë“¤ ì •ë³´ (ë©”ì‹œì§€ ì¶”ê°€)
        const patients = [
            { type: 'ìƒì²˜', injuryPart: 'íŒ”', correctTool: 'ë°´ë“œ', patientEmoji: 'ğŸ‘§', injuryEmoji: 'ğŸ©¸', injuryPosition: { top: '60%', left: '30%' }, message: 'íŒ”ì— í”¼ê°€ ë‚˜ìš”! ì•„íŒŒìš” ğŸ˜­' },
            { type: 'ê°€ì‹œ', injuryPart: 'ì†', correctTool: 'í•€ì…‹', patientEmoji: 'ğŸ‘¦', injuryEmoji: 'ğŸŒµ', injuryPosition: { top: '70%', left: '70%' }, message: 'ì†ì— ê°€ì‹œê°€ ë°•í˜”ì–´ìš” ì°”ë ¸ì–´ìš” ğŸ˜–' },
            { type: 'ë…ê°', injuryPart: 'ëª¸', correctTool: 'ì£¼ì‚¬ê¸°', patientEmoji: 'ğŸ§’', injuryEmoji: 'ğŸ¤’', injuryPosition: { top: '40%', left: '50%' }, message: 'ì—´ì´ ë‚˜ê³  ìœ¼ìŠ¬ìœ¼ìŠ¬í•´ìš” ğŸ˜·' },
            { type: 'ê³¨ì ˆ', injuryPart: 'ë‹¤ë¦¬', correctTool: 'ë¶•ëŒ€', patientEmoji: 'ğŸ§‘', injuryEmoji: 'ğŸ¦´', injuryPosition: { top: '80%', left: '50%' }, message: 'ë‹¤ë¦¬ê°€ ë¶€ëŸ¬ì§„ ê²ƒ ê°™ì•„ìš” ë¼ˆê°€ ì•„íŒŒìš” ğŸ˜«' },
            { type: 'ë‘í†µ', injuryPart: 'ë¨¸ë¦¬', correctTool: 'ì•½', patientEmoji: 'ğŸ‘©', injuryEmoji: 'ğŸ¤¯', injuryPosition: { top: '20%', left: '50%' }, message: 'ë¨¸ë¦¬ê°€ ë„ˆë¬´ ì•„íŒŒìš” ëµí•´ìš” ğŸ˜µ' },
            { type: 'ë²Œë ˆë¬¼ë¦¼', injuryPart: 'ëª©', correctTool: 'ì†œ', patientEmoji: 'ğŸ‘¨', injuryEmoji: 'ğŸ', injuryPosition: { top: '30%', left: '60%' }, message: 'ë²Œì— ë¬¼ë ¤ì„œ ëª©ì´ ê°„ì§€ëŸ¬ì›Œìš” ğŸ' },
            { type: 'ë©', injuryPart: 'ì´ë§ˆ', correctTool: 'ì–¼ìŒì°œì§ˆ', patientEmoji: 'ğŸ‘¶', injuryEmoji: 'ğŸ¤•', injuryPosition: { top: '30%', left: '50%' }, message: 'ì¿µ! ì´ë§ˆì— ë©ë“¤ì—ˆì–´ìš” ğŸ¤•' },
            { type: 'ëˆˆë³‘', injuryPart: 'ëˆˆ', correctTool: 'ì•ˆì•½', patientEmoji: 'ğŸ‘µ', injuryEmoji: 'ğŸ‘€', injuryPosition: { top: '35%', left: '45%' }, message: 'ëˆˆì´ ë„ˆë¬´ ê°€ë ¤ì›Œìš” ğŸ˜©' },
            { type: 'ë°°íƒˆ', injuryPart: 'ë°°', correctTool: 'ì•½', patientEmoji: 'ğŸ§“', injuryEmoji: 'ğŸ¤¢', injuryPosition: { top: '60%', left: '50%' }, message: 'ë°°ê°€ ë„ˆë¬´ ì•„íŒŒìš” ê¾¸ë¥´ë¥µ ğŸ¤¢' },
            { type: 'ì¹˜í†µ', injuryPart: 'ì´ë¹¨', correctTool: 'ì•½', patientEmoji: 'ğŸ‘´', injuryEmoji: 'ğŸ¦·', injuryPosition: { top: '45%', left: '40%' }, message: 'ì´ê°€ ë„ˆë¬´ ì•„íŒŒìš” ğŸ˜¬' },
            // ìƒˆë¡œ ì¶”ê°€ëœ í™˜ìë“¤
            { type: 'ëª©ê°ê¸°', injuryPart: 'ëª©', correctTool: 'ì•½', patientEmoji: 'ğŸ‘©â€ğŸ¦°', injuryEmoji: 'ğŸ¤§', injuryPosition: { top: '35%', left: '55%' }, message: 'ëª©ì´ ì¹¼ì¹¼í•˜ê³  ì•„íŒŒìš” ğŸ¤§' },
            { type: 'ì½§ë¬¼', injuryPart: 'ì½”', correctTool: 'ì•½', patientEmoji: 'ğŸ‘±â€â™€ï¸', injuryEmoji: 'ğŸ‘ƒ', injuryPosition: { top: '30%', left: '50%' }, message: 'ì½§ë¬¼ì´ ì¤„ì¤„ í˜ëŸ¬ìš” ğŸ’§' },
            { type: 'ê°ê¸°', injuryPart: 'ëª¸', correctTool: 'ì•½', patientEmoji: 'ğŸ§‘â€ğŸ¦±', injuryEmoji: 'ğŸ¥¶', injuryPosition: { top: '50%', left: '50%' }, message: 'ìœ¼ìŠ¬ìœ¼ìŠ¬ ê°ê¸° ê±¸ë ¸ì–´ìš” ğŸ¤’' },
            { type: 'í™”ìƒ', injuryPart: 'ì†', correctTool: 'í™”ìƒì—°ê³ ', patientEmoji: 'ğŸ‘©â€ğŸ¦³', injuryEmoji: 'ğŸ”¥', injuryPosition: { top: '65%', left: '60%' }, message: 'ëœ¨ê±°ì›Œìš”! ì†ì— í™”ìƒ ì…ì—ˆì–´ìš” â™¨ï¸' },
            { type: 'ë°œëª©ì‚ë—', injuryPart: 'ë°œëª©', correctTool: 'íŒŒìŠ¤', patientEmoji: 'ğŸ‘¨â€ğŸ¦°', injuryEmoji: 'ğŸ¦¶', injuryPosition: { top: '85%', left: '40%' }, message: 'ë°œëª©ì„ ì‚ë—í–ˆì–´ìš” ì‚ë— ğŸ¦¶' },
            { type: 'ë°°ê³ í””', injuryPart: 'ë°°', correctTool: 'ìŒì‹', patientEmoji: 'ğŸ‘§', injuryEmoji: 'ğŸ”', injuryPosition: { top: '60%', left: '50%' }, message: 'ë°°ê°€ ë„ˆë¬´ ê³ íŒŒìš”! ê¼¬ë¥´ë¥µ ğŸ¤¤' },
            { type: 'ì¡¸ë¦¼', injuryPart: 'ë¨¸ë¦¬', correctTool: 'ë² ê°œ', patientEmoji: 'ğŸ˜´', injuryEmoji: 'ğŸ’¤', injuryPosition: { top: '25%', left: '50%' }, message: 'ë„ˆë¬´ ì¡¸ë ¤ìš” ğŸ˜´ ì ì´ ì™€ìš”' },
            { type: 'í”¼ê³¤í•¨', injuryPart: 'ëª¸', correctTool: 'ë¹„íƒ€ë¯¼', patientEmoji: 'ğŸ˜©', injuryEmoji: 'âš¡', injuryPosition: { top: '50%', left: '50%' }, message: 'ë„ˆë¬´ í”¼ê³¤í•´ìš” ì—ë„ˆì§€ê°€ ì—†ì–´ìš” ğŸ˜©' },
            { type: 'ë”¸ê¾¹ì§ˆ', injuryPart: 'ëª¸', correctTool: 'ë¬¼', patientEmoji: 'ğŸ˜µ', injuryEmoji: 'ğŸ’§', injuryPosition: { top: '55%', left: '50%' }, message: 'ë”¸ê¾¹ë”¸ê¾¹ ë©ˆì¶”ì§€ ì•Šì•„ìš” ğŸ’¦' },
            { type: 'í”¼ë¶€ê°€ë ¤ì›€', injuryPart: 'íŒ”', correctTool: 'ì—°ê³ ', patientEmoji: ' scratching_head', injuryEmoji: 'âœ¨', injuryPosition: { top: '60%', left: '30%' }, message: 'í”¼ë¶€ê°€ ë„ˆë¬´ ê°€ë ¤ì›Œìš” ê¸ì ê¸ì  ğŸ˜«' },
            { type: 'ë©€ë¯¸', injuryPart: 'ë¨¸ë¦¬', correctTool: 'ë©€ë¯¸ì•½', patientEmoji: 'ğŸ¤¢', injuryEmoji: 'ğŸ¤®', injuryPosition: { top: '30%', left: '50%' }, message: 'ì–´ì§€ëŸ¬ì›Œìš” ë©€ë¯¸ë‚˜ìš” ğŸ¤¢' }
        ];

        // HTML ìš”ì†Œ ê°€ì ¸ì˜¤ê¸°
        const toolsContainer = document.getElementById('toolsContainer');
        const patientEmojiEl = document.getElementById('patientEmoji');
        const injurySpotEl = document.getElementById('injurySpot');
        const treatedPatientsCountEl = document.getElementById('treatedPatientsCount');
        const messageBoxEl = document.getElementById('messageBox');
        const patientAreaEl = document.getElementById('patientArea');
        const waitingMessageEl = document.getElementById('waitingMessage');

        // ê²Œì„ ìƒíƒœ ë³€ìˆ˜
        let treatedPatientsCount = 0; // ì¹˜ë£Œí•œ í™˜ì ìˆ˜
        let selectedToolName = null; // í˜„ì¬ ì„ íƒëœ ë„êµ¬ ì´ë¦„
        let currentPatient = null; // í˜„ì¬ í™˜ì ì •ë³´
        let isPatientArriving = false; // í™˜ìê°€ ì˜¤ê³  ìˆëŠ”ì§€ ì—¬ë¶€
        let audioContextStarted = false; // ì˜¤ë””ì˜¤ ì»¨í…ìŠ¤íŠ¸ ì‹œì‘ ì—¬ë¶€
        let pressTimer = null; // ê¸¸ê²Œ í´ë¦­ ê°ì§€ë¥¼ ìœ„í•œ íƒ€ì´ë¨¸
        let isLongPress = false; // ê¸¸ê²Œ í´ë¦­ ì¤‘ì¸ì§€ ì—¬ë¶€

        // Tone.js ì‚¬ìš´ë“œ ê°ì²´ ì´ˆê¸°í™”
        let correctSound = null;
        let incorrectSound = null;
        let arrivalSound = null;

        /**
         * Tone.js ì‚¬ìš´ë“œë¥¼ ì„¤ì •í•˜ëŠ” í•¨ìˆ˜
         */
        function setupSounds() {
            try {
                // ì¹˜ë£Œ ì„±ê³µ ì‚¬ìš´ë“œ: í–‰ë³µí•œ ì¢…ì†Œë¦¬ ëŠë‚Œ
                correctSound = new Tone.PolySynth(Tone.Synth, {
                    oscillator: { type: "triangle" },
                    envelope: { attack: 0.01, decay: 0.2, sustain: 0.1, release: 0.5 }
                }).toDestination();

                // ì¹˜ë£Œ ì‹¤íŒ¨ ì‚¬ìš´ë“œ: ì§§ê³  ë‚®ì€ 'ë¿…' ì†Œë¦¬
                incorrectSound = new Tone.Synth({
                    oscillator: { type: "sine" },
                    envelope: { attack: 0.01, decay: 0.1, sustain: 0, release: 0.1 }
                }).toDestination();

                // í™˜ì ë„ì°© ì‚¬ìš´ë“œ: ë¶€ë“œëŸ¬ìš´ ì¢…ì†Œë¦¬
                arrivalSound = new Tone.Synth({
                    oscillator: { type: "sine" },
                    envelope: { attack: 0.05, decay: 0.3, sustain: 0, release: 0.5 }
                }).toDestination();

            } catch (e) {
                console.error("Tone.js ì‚¬ìš´ë“œ ì„¤ì • ì‹¤íŒ¨:", e);
            }
        }

        /**
         * ì˜¤ë””ì˜¤ ì»¨í…ìŠ¤íŠ¸ë¥¼ ì‹œì‘í•˜ëŠ” í•¨ìˆ˜ (ì‚¬ìš©ì ìƒí˜¸ì‘ìš© ì‹œ í˜¸ì¶œ)
         */
        function startAudioContext() {
            if (!audioContextStarted) {
                Tone.start();
                audioContextStarted = true;
                console.log("ì˜¤ë””ì˜¤ ì»¨í…ìŠ¤íŠ¸ ì‹œì‘ë¨.");
            }
        }

        /**
         * ì¹˜ë£Œ ì„±ê³µ ì‚¬ìš´ë“œë¥¼ ì¬ìƒí•˜ëŠ” í•¨ìˆ˜
         */
        function playCorrectSound() {
            if (correctSound) {
                correctSound.triggerAttackRelease(["C5", "E5", "G5"], "8n"); // í–‰ë³µí•œ ì•„ë¥´í˜ì§€ì˜¤
            }
        }

        /**
         * ì¹˜ë£Œ ì‹¤íŒ¨ ì‚¬ìš´ë“œë¥¼ ì¬ìƒí•˜ëŠ” í•¨ìˆ˜
         */
        function playIncorrectSound() {
            if (incorrectSound) {
                incorrectSound.triggerAttackRelease("C3", "16n"); // ë‚®ì€ 'ë¿…' ì†Œë¦¬
            }
        }

        /**
         * í™˜ì ë„ì°© ì‚¬ìš´ë“œë¥¼ ì¬ìƒí•˜ëŠ” í•¨ìˆ˜
         */
        function playArrivalSound() {
            if (arrivalSound) {
                arrivalSound.triggerAttackRelease("G4", "4n"); // ë¶€ë“œëŸ¬ìš´ ì¢…ì†Œë¦¬
            }
        }

        /**
         * í…ìŠ¤íŠ¸ë¥¼ ìŒì„±ìœ¼ë¡œ ë³€í™˜í•˜ì—¬ ì¬ìƒí•˜ëŠ” í•¨ìˆ˜
         * @param {string} text - ì¬ìƒí•  í…ìŠ¤íŠ¸
         */
        function speakMessage(text) {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'ko-KR'; // í•œêµ­ì–´ ì„¤ì •
                utterance.rate = 1.0; // ë§í•˜ëŠ” ì†ë„ (ê¸°ë³¸ê°’ 1.0)
                utterance.pitch = 1.0; // ìŒë†’ì´ (ê¸°ë³¸ê°’ 1.0)
                // ìŒì„± ì„ íƒ (ì„ íƒ ì‚¬í•­, íŠ¹ì • ìŒì„±ì„ ì›í•  ê²½ìš°)
                // let voices = window.speechSynthesis.getVoices();
                // utterance.voice = voices.find(voice => voice.lang === 'ko-KR' && voice.name.includes('Google í•œêµ­ì–´'));

                window.speechSynthesis.speak(utterance);
            } else {
                console.warn("Speech Synthesis APIë¥¼ ì§€ì›í•˜ì§€ ì•ŠëŠ” ë¸Œë¼ìš°ì €ì…ë‹ˆë‹¤.");
            }
        }

        /**
         * ê²Œì„ì„ ì´ˆê¸°í™”í•˜ëŠ” í•¨ìˆ˜
         */
        function initGame() {
            setupSounds(); // ì‚¬ìš´ë“œ ì„¤ì •
            renderTools(); // ë„êµ¬ ë²„íŠ¼ë“¤ì„ í™”ë©´ì— ê·¸ë¦½ë‹ˆë‹¤.
            generatePatient(); // ì²« ë²ˆì§¸ í™˜ìë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
            updateScore(); // ì ìˆ˜ë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
        }

        /**
         * ì„ íƒëœ ë„êµ¬ë¥¼ í™˜ì ë¶€ìƒ ë¶€ìœ„ë¡œ ì• ë‹ˆë©”ì´ì…˜ì‹œí‚¤ëŠ” í•¨ìˆ˜
         * @param {string} toolName - ì• ë‹ˆë©”ì´ì…˜í•  ë„êµ¬ì˜ ì´ë¦„
         * @param {number} startX - ì‹œì‘ X ì¢Œí‘œ
         * @param {number} startY - ì‹œì‘ Y ì¢Œí‘œ
         */
        function animateToolToPatient(toolName, startX, startY) {
            const toolInfo = tools.find(t => t.name === toolName);
            if (!toolInfo) return;

            const clone = document.createElement('div');
            clone.innerHTML = `${toolInfo.icon}`; // ì´ë™í•  ë•ŒëŠ” ì•„ì´ì½˜ë§Œ í‘œì‹œ
            clone.className = 'fixed bg-pink-400 text-white rounded-full p-4 text-4xl shadow-lg transition-all duration-600 ease-in-out z-50 flex items-center justify-center';
            clone.style.left = `${startX}px`;
            clone.style.top = `${startY}px`;
            clone.style.transform = 'translate(-50%, -50%)'; // ì¤‘ì•™ ì •ë ¬

            document.body.appendChild(clone); // bodyì— ì¶”ê°€í•˜ì—¬ í´ë¦¬í•‘ ë°©ì§€

            // íƒ€ê²Ÿ ìœ„ì¹˜ (ë¶€ìƒ ë¶€ìœ„) ê³„ì‚°
            const injuryRect = injurySpotEl.getBoundingClientRect();
            const targetX = injuryRect.left + injuryRect.width / 2;
            const targetY = injuryRect.top + injuryRect.height / 2;

            // ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘ (ì•½ê°„ì˜ ë”œë ˆì´ í›„)
            setTimeout(() => {
                clone.style.left = `${targetX}px`;
                clone.style.top = `${targetY}px`;
            }, 50); // ì§§ì€ ë”œë ˆì´ í›„ ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘

            clone.addEventListener('transitionend', () => {
                clone.remove(); // ì• ë‹ˆë©”ì´ì…˜ ì™„ë£Œ í›„ í´ë¡  ì œê±°
                applyToolLogic(0.6); // 0.6ì´ˆ ë”œë ˆì´ í›„ ì¹˜ë£Œ ë¡œì§ ì‹¤í–‰
            }, { once: true }); // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆëŠ” í•œ ë²ˆë§Œ ì‹¤í–‰
        }

        /**
         * ë„êµ¬ ë²„íŠ¼ë“¤ì„ í™”ë©´ì— ê·¸ë¦¬ëŠ” í•¨ìˆ˜
         */
        function renderTools() {
            toolsContainer.innerHTML = ''; // ê¸°ì¡´ ë„êµ¬ë“¤ì„ ì§€ì›ë‹ˆë‹¤.
            tools.forEach(tool => {
                const button = document.createElement('button');
                // Tailwind CSS í´ë˜ìŠ¤ ì ìš©
                button.className = 'tool-button bg-pink-200 text-pink-800 py-3 px-6 rounded-full text-2xl font-bold cursor-pointer transition-all duration-200 ease-in-out border-2 border-transparent flex items-center gap-2 hover:bg-pink-300 hover:scale-105 hover:shadow-md';
                button.innerHTML = `${tool.icon} ${tool.name}`; // ì´ëª¨ì§€ì™€ ì´ë¦„ í‘œì‹œ
                button.dataset.toolName = tool.name; // ë„êµ¬ ì´ë¦„ì„ ë°ì´í„° ì†ì„±ìœ¼ë¡œ ì €ì¥

                // ë§ˆìš°ìŠ¤ í´ë¦­ ì‹œì‘ ì´ë²¤íŠ¸ (ê¸¸ê²Œ í´ë¦­ ê°ì§€ ì‹œì‘)
                button.addEventListener('mousedown', (e) => {
                    startAudioContext();
                    selectTool(tool.name); // ë„êµ¬ ì‹œê°ì ìœ¼ë¡œ ì„ íƒ

                    const rect = e.target.getBoundingClientRect();
                    const startX = rect.left + rect.width / 2;
                    const startY = rect.top + rect.height / 2;

                    // ì´ì „ íƒ€ì´ë¨¸ê°€ ìˆë‹¤ë©´ í´ë¦¬ì–´
                    if (pressTimer) clearTimeout(pressTimer);
                    isLongPress = false; // ê¸¸ê²Œ í´ë¦­ ìƒíƒœ ì´ˆê¸°í™”

                    pressTimer = setTimeout(() => {
                        isLongPress = true; // 0.5ì´ˆ ì´ìƒ ëˆŒë €ìœ¼ë‹ˆ ê¸¸ê²Œ í´ë¦­ìœ¼ë¡œ ê°„ì£¼
                        animateToolToPatient(tool.name, startX, startY); // ë„êµ¬ ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
                    }, 500); // 0.5ì´ˆ
                });

                // ë§ˆìš°ìŠ¤ í´ë¦­ ë ì´ë²¤íŠ¸ (ê¸¸ê²Œ í´ë¦­ ê°ì§€ ì¤‘ì§€)
                button.addEventListener('mouseup', () => {
                    clearTimeout(pressTimer); // íƒ€ì´ë¨¸ ì¤‘ì§€
                    if (!isLongPress && selectedToolName) { // ì§§ê²Œ í´ë¦­í–ˆê³ , ë„êµ¬ê°€ ì„ íƒëœ ìƒíƒœë¼ë©´
                        // ì•„ë¬´ê²ƒë„ í•˜ì§€ ì•ŠìŒ. ë¶€ìƒ ë¶€ìœ„ í´ë¦­ ì‹œ ì¹˜ë£Œ ë¡œì§ì´ ì‹¤í–‰ë¨.
                    }
                });

                // ë§ˆìš°ìŠ¤ê°€ ë²„íŠ¼ ë°–ìœ¼ë¡œ ë²—ì–´ë‚˜ëŠ” ì´ë²¤íŠ¸ (ê¸¸ê²Œ í´ë¦­ ê°ì§€ ì¤‘ì§€)
                button.addEventListener('mouseleave', () => {
                    clearTimeout(pressTimer); // íƒ€ì´ë¨¸ ì¤‘ì§€
                    // ë§ˆìš°ìŠ¤ê°€ ë²„íŠ¼ ë°–ìœ¼ë¡œ ë‚˜ê°€ë©´ ê¸¸ê²Œ í´ë¦­ì´ ì•„ë‹ˆë¯€ë¡œ isLongPressëŠ” ê·¸ëŒ€ë¡œ false ìœ ì§€
                });

                toolsContainer.appendChild(button);
            });
        }

        /**
         * ìƒˆë¡œìš´ í™˜ìë¥¼ ìƒì„±í•˜ê³  í™”ë©´ì— í‘œì‹œí•˜ëŠ” í•¨ìˆ˜
         */
        function generatePatient() {
            isPatientArriving = false; // í™˜ì ë„ì°© ìƒíƒœ í•´ì œ
            waitingMessageEl.classList.add('hidden'); // ëŒ€ê¸° ë©”ì‹œì§€ ìˆ¨ê¸°ê¸°
            patientAreaEl.style.backgroundColor = '#ffebee'; // í™˜ì ì˜ì—­ ì›ë˜ ìƒ‰ìœ¼ë¡œ ë˜ëŒë¦¬ê¸° (ì»¤ìŠ¤í…€ CSS ìœ ì§€)

            // ëœë¤ìœ¼ë¡œ í™˜ì ì„ íƒ
            const randomIndex = Math.floor(Math.random() * patients.length);
            currentPatient = patients[randomIndex];

            // í™˜ì ì´ëª¨ì§€ ë° ë¶€ìƒ ë¶€ìœ„ ìœ„ì¹˜ ì—…ë°ì´íŠ¸ (ì£¼ì‚¬ê¸° í™˜ì íŠ¹ë³„ ì²˜ë¦¬)
            if (currentPatient.type === 'ë…ê°') {
                patientEmojiEl.textContent = 'ğŸ§'; // ì„œ ìˆëŠ” ì‚¬ëŒ ì´ëª¨ì§€ (ì—‰ë©ì´ ì£¼ì‚¬)
                injurySpotEl.textContent = currentPatient.injuryEmoji; // 'ğŸ¤’' ìœ ì§€
                injurySpotEl.style.top = '75%'; // ì—‰ë©ì´ ìœ„ì¹˜
                injurySpotEl.style.left = '50%';
            } else {
                patientEmojiEl.textContent = currentPatient.patientEmoji;
                injurySpotEl.textContent = currentPatient.injuryEmoji;
                injurySpotEl.style.top = currentPatient.injuryPosition.top;
                injurySpotEl.style.left = currentPatient.injuryPosition.left;
            }

            injurySpotEl.classList.remove('hidden'); // ë¶€ìƒ ë¶€ìœ„ ë³´ì´ê²Œ í•˜ê¸°
            injurySpotEl.classList.remove('pointer-events-none'); // í´ë¦­ ê°€ëŠ¥í•˜ê²Œ ì„¤ì •
            injurySpotEl.classList.add('cursor-pointer'); // ì»¤ì„œ ë³€ê²½

            // í™˜ì ìƒí™©ì— ë§ëŠ” ë©”ì‹œì§€ í‘œì‹œ ë° ìŒì„± ì¬ìƒ
            showMessage(currentPatient.message);
            speakMessage(currentPatient.message); // í™˜ì ë©”ì‹œì§€ ìŒì„± ì¬ìƒ
            playArrivalSound(); // í™˜ì ë„ì°© ì‚¬ìš´ë“œ ì¬ìƒ

            // ì„ íƒëœ ë„êµ¬ ì´ˆê¸°í™” ë° ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì´ˆê¸°í™”
            selectedToolName = null;
            document.querySelectorAll('.tool-button').forEach(btn => {
                btn.classList.remove('selected', 'border-pink-600', 'bg-pink-600', 'text-white'); // Tailwind í´ë˜ìŠ¤ë„ í•¨ê»˜ ì œê±°
            });
        }

        /**
         * ë„êµ¬ë¥¼ ì„ íƒí•˜ëŠ” í•¨ìˆ˜ (ì‹œê°ì  ì„ íƒë§Œ ë‹´ë‹¹)
         * @param {string} toolName - ì„ íƒëœ ë„êµ¬ì˜ ì´ë¦„
         */
        function selectTool(toolName) {
            if (isPatientArriving) return; // í™˜ì ë„ì°© ì¤‘ì—ëŠ” ë„êµ¬ ì„ íƒ ë¶ˆê°€

            selectedToolName = toolName;
            // ëª¨ë“  ë„êµ¬ ë²„íŠ¼ì˜ 'selected' í´ë˜ìŠ¤ë¥¼ ì œê±°
            document.querySelectorAll('.tool-button').forEach(btn => {
                btn.classList.remove('selected', 'border-pink-600', 'bg-pink-600', 'text-white'); // Tailwind í´ë˜ìŠ¤ë„ í•¨ê»˜ ì œê±°
            });
            // ì„ íƒëœ ë„êµ¬ ë²„íŠ¼ì— 'selected' í´ë˜ìŠ¤ ì¶”ê°€
            const selectedButton = document.querySelector(`.tool-button[data-tool-name="${toolName}"]`);
            if (selectedButton) {
                selectedButton.classList.add('selected', 'border-pink-600', 'bg-pink-600', 'text-white'); // Tailwind í´ë˜ìŠ¤ ì¶”ê°€
            }
        }

        /**
         * í™˜ìì˜ ë¶€ìƒ ë¶€ìœ„ë¥¼ í´ë¦­í–ˆì„ ë•Œ ë˜ëŠ” ë„êµ¬ ì• ë‹ˆë©”ì´ì…˜ ì™„ë£Œ í›„ ì¹˜ë£Œ ë¡œì§ì„ ì‹¤í–‰í•˜ëŠ” í•¨ìˆ˜
         * @param {number} delay - ì¹˜ë£Œ ë¡œì§ ì‹¤í–‰ ì „ ëŒ€ê¸°í•  ì‹œê°„ (ì´ˆ ë‹¨ìœ„)
         */
        function applyToolLogic(delay = 0) {
            // ê¸°ì¡´ì— ì¬ìƒ ì¤‘ì¸ ìŒì„±ì´ ìˆë‹¤ë©´ ì·¨ì†Œ
            window.speechSynthesis.cancel();
            startAudioContext(); // Tone.js ì˜¤ë””ì˜¤ ì»¨í…ìŠ¤íŠ¸ í™œì„±í™” í™•ì¸

            setTimeout(() => {
                if (!selectedToolName) {
                    showMessage('ë¨¼ì € ë„êµ¬ë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”!', 'orange');
                    speakMessage('ë¨¼ì € ë„êµ¬ë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”!'); // ìŒì„± ì¬ìƒ
                    isLongPress = false; // ê¸¸ê²Œ í´ë¦­ ìƒíƒœ ì´ˆê¸°í™”
                    return;
                }

                if (currentPatient && selectedToolName === currentPatient.correctTool) {
                    // ì˜¬ë°”ë¥¸ ë„êµ¬ë¡œ ì¹˜ë£Œ ì„±ê³µ
                    treatedPatientsCount++;
                    updateScore();
                    const successMessage = 'ğŸ‰ ì¹˜ë£Œ ì„±ê³µ! ë‹¤ìŒ í™˜ìê°€ ì˜¤ê³  ìˆì–´ìš”!';
                    showMessage(successMessage, 'green');
                    speakMessage(successMessage); // ìŒì„± ì¬ìƒ
                    playCorrectSound(); // ì„±ê³µ ì‚¬ìš´ë“œ ì¬ìƒ

                    // ì„±ê³µ ì• ë‹ˆë©”ì´ì…˜ ì¶”ê°€ ë° ë¶€ìƒ ë¶€ìœ„ ìˆ¨ê¸°ê¸°
                    injurySpotEl.classList.add('animate-pop-injury');
                    setTimeout(() => {
                        injurySpotEl.classList.remove('animate-pop-injury');
                        injurySpotEl.classList.add('hidden'); // ì• ë‹ˆë©”ì´ì…˜ í›„ ìˆ¨ê¸°ê¸°
                        injurySpotEl.classList.add('pointer-events-none'); // í´ë¦­ ë¹„í™œì„±í™”
                    }, 300); // ì• ë‹ˆë©”ì´ì…˜ ì§€ì† ì‹œê°„

                    patientEmojiEl.textContent = 'ğŸ˜Š'; // í™˜ì ì›ƒëŠ” ì–¼êµ´ë¡œ ë³€ê²½
                    patientEmojiEl.classList.add('animate-bounce-emoji');
                    setTimeout(() => {
                        patientEmojiEl.classList.remove('animate-bounce-emoji');
                    }, 500); // ì• ë‹ˆë©”ì´ì…˜ ì§€ì† ì‹œê°„

                    isPatientArriving = true; // í™˜ì ë„ì°© ìƒíƒœ ì„¤ì •
                    waitingMessageEl.classList.remove('hidden'); // ëŒ€ê¸° ë©”ì‹œì§€ í‘œì‹œ
                    patientAreaEl.style.backgroundColor = '#c8e6c9'; /* ì¹˜ë£Œ ì„±ê³µ ì‹œ ì—°í•œ ì´ˆë¡ìƒ‰ ë°°ê²½ (ì»¤ìŠ¤í…€ CSS ìœ ì§€) */

                    // 1ì´ˆ í›„ ë‹¤ìŒ í™˜ì ìƒì„±
                    setTimeout(() => {
                        isLongPress = false; // ê¸¸ê²Œ í´ë¦­ ìƒíƒœ ì´ˆê¸°í™”
                        generatePatient();
                    }, 1000); // ì›ë˜ í™˜ì ë„ì°© ëŒ€ê¸° ì‹œê°„
                } else {
                    // ì˜ëª»ëœ ë„êµ¬ë¡œ ì¹˜ë£Œ ì‹œë„
                    const wrongMessages = ['ì•„íŒŒìš”!', 'ê°„ì§€ëŸ¬ì›Œìš”!', 'ì•„ì•¼!', 'ìœ¼ì•™!', 'ë”°ë”í•´ìš”!'];
                    const randomMessage = wrongMessages[Math.floor(Math.random() * wrongMessages.length)];
                    const fullWrongMessage = `ğŸ˜­ ${randomMessage} (ì˜ëª»ëœ ë„êµ¬ì˜ˆìš”!)`;
                    showMessage(fullWrongMessage, 'red');
                    speakMessage(randomMessage); // ì˜ëª»ëœ ì¹˜ë£Œ ë©”ì‹œì§€ ìŒì„± ì¬ìƒ (ì´ëª¨ì§€ ì œì™¸)
                    playIncorrectSound(); // ì‹¤íŒ¨ ì‚¬ìš´ë“œ ì¬ìƒ

                    // ì‹¤íŒ¨ ì• ë‹ˆë©”ì´ì…˜ ì¶”ê°€ (ë¶€ìƒ ë¶€ìœ„ë„ íŒ)
                    injurySpotEl.classList.add('animate-pop-injury');
                    setTimeout(() => {
                        injurySpotEl.classList.remove('animate-pop-injury');
                    }, 300); // ì• ë‹ˆë©”ì´ì…˜ ì§€ì† ì‹œê°„

                    patientEmojiEl.classList.add('animate-shake-emoji');
                    setTimeout(() => {
                        patientEmojiEl.classList.remove('animate-shake-emoji');
                    }, 300); // ì• ë‹ˆë©”ì´ì…˜ ì§€ì† ì‹œê°„
                    isLongPress = false; // ê¸¸ê²Œ í´ë¦­ ìƒíƒœ ì´ˆê¸°í™”
                }
            }, delay * 1000); // ì´ˆ ë‹¨ìœ„ë¥¼ ë°€ë¦¬ì´ˆë¡œ ë³€í™˜
        }

        /**
         * ì¹˜ë£Œí•œ í™˜ì ìˆ˜ë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” í•¨ìˆ˜
         */
        function updateScore() {
            treatedPatientsCountEl.textContent = treatedPatientsCount;
        }

        /**
         * ë©”ì‹œì§€ ë°•ìŠ¤ì— ë©”ì‹œì§€ë¥¼ í‘œì‹œí•˜ëŠ” í•¨ìˆ˜
         * @param {string} message - í‘œì‹œí•  ë©”ì‹œì§€
         * @param {string} type - ë©”ì‹œì§€ íƒ€ì… (green, red, orange ë“±)ì— ë”°ë¼ ìƒ‰ìƒ ë³€ê²½
         */
        function showMessage(message, type = 'default') {
            messageBoxEl.textContent = message;
            // ê¸°ì¡´ íƒ€ì… í´ë˜ìŠ¤ ì œê±° í›„ ìƒˆ íƒ€ì… í´ë˜ìŠ¤ ì¶”ê°€
            messageBoxEl.classList.remove('type-green', 'type-red', 'type-orange');
            // Tailwind í´ë˜ìŠ¤ë„ í•¨ê»˜ ì œê±° (ë©”ì‹œì§€ ë°•ìŠ¤ ê¸°ë³¸ ìŠ¤íƒ€ì¼ì€ ìœ ì§€)
            messageBoxEl.classList.remove('bg-green-100', 'text-green-800', 'border-green-300',
                                        'bg-red-100', 'text-red-800', 'border-red-300',
                                        'bg-orange-100', 'text-orange-800', 'border-orange-300');


            if (type === 'green') {
                messageBoxEl.classList.add('type-green', 'bg-green-100', 'text-green-800', 'border-green-300');
            } else if (type === 'red') {
                messageBoxEl.classList.add('type-red', 'bg-red-100', 'text-red-800', 'border-red-300');
            } else if (type === 'orange') {
                messageBoxEl.classList.add('type-orange', 'bg-orange-100', 'text-orange-800', 'border-orange-300');
            } else {
                // ê¸°ë³¸ ë©”ì‹œì§€ ìŠ¤íƒ€ì¼ (Tailwind í´ë˜ìŠ¤)
                messageBoxEl.classList.add('bg-white', 'text-gray-800', 'border-pink-200');
            }
            // ê¸°ë³¸ ìŠ¤íƒ€ì¼ í´ë˜ìŠ¤ëŠ” ìœ ì§€
            messageBoxEl.classList.add('message-box');
        }

        // ë¶€ìƒ ë¶€ìœ„ í´ë¦­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€ (ì§§ê²Œ í´ë¦­í–ˆì„ ë•Œë§Œ ì‘ë™)
        injurySpotEl.addEventListener('click', () => {
            if (isPatientArriving) return; // í™˜ì ë„ì°© ì¤‘ì—ëŠ” í´ë¦­ ë¬´ì‹œ
            if (isLongPress) return; // ê¸¸ê²Œ í´ë¦­ ì¤‘ì—ëŠ” í´ë¦­ ë¬´ì‹œ (ì• ë‹ˆë©”ì´ì…˜ì´ ëŒ€ì‹  ì²˜ë¦¬)

            // ë„êµ¬ê°€ ì„ íƒëœ ìƒíƒœì´ê³ , ì§§ê²Œ í´ë¦­í•œ ê²½ìš°ì—ë§Œ ì¹˜ë£Œ ë¡œì§ ì‹¤í–‰
            if (selectedToolName) {
                applyToolLogic(0); // ì¶”ê°€ ë”œë ˆì´ ì—†ì´ ë°”ë¡œ ì¹˜ë£Œ ë¡œì§ ì‹¤í–‰
            } else {
                showMessage('ë¨¼ì € ë„êµ¬ë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”!', 'orange');
                speakMessage('ë¨¼ì € ë„êµ¬ë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”!');
            }
        });

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ê²Œì„ ì´ˆê¸°í™”
        window.onload = initGame;
    </script>
</body>
