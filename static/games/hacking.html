<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•´í‚¹ ê²Œì„</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=VT323&display=swap');
        body {
            background-color: #0d1117;
            color: #00ff00;
            font-family: 'VT323', monospace;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
        }
        .code-rain {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
            opacity: 0.1;
            z-index: -1;
        }
        .matrix-text {
            position: absolute;
            white-space: pre;
            color: #00cc00;
        }
        .game-container {
            position: relative;
            z-index: 10;
            background-color: rgba(0, 0, 0, 0.7);
            border: 2px solid #00ff00;
            border-radius: 1rem;
            padding: 2rem;
            box-shadow: 0 0 20px #00ff00;
            width: 90%;
            max-width: 600px;
            text-align: center;
        }
        .button {
            background-color: #00ff00;
            color: #0d1117;
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            font-size: 1.25rem;
            font-weight: bold;
            transition: all 0.2s ease-in-out;
            cursor: pointer;
            margin-top: 1rem;
            box-shadow: 0 4px 6px rgba(0, 255, 0, 0.5);
        }
        .button:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 8px rgba(0, 255, 0, 0.7);
        }
        .input-box {
            background-color: rgba(255, 255, 255, 0.1);
            color: #00ff00;
            border: 2px solid #00ff00;
            border-radius: 0.5rem;
            padding: 0.5rem;
            width: 100%;
            margin-top: 1rem;
            font-size: 1.25rem;
            text-align: center;
        }
        #message-box {
            background-color: #1a1a1a;
            border: 1px solid #00ff00;
            border-radius: 0.5rem;
            padding: 1rem;
            margin-top: 1rem;
            min-height: 50px;
        }
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }
        .cursor {
            animation: blink 1s step-end infinite;
        }
    </style>
</head>
<body class="bg-gray-900 text-green-400 flex flex-col items-center justify-center h-screen">

    <!-- Code Rain Effect -->
    <div class="code-rain"></div>

    <!-- í•´í‚¹ ì„±ê³µ ì‹œ ì¬ìƒí•  ì†Œë¦¬ (ì•ˆ ë³´ì´ê²Œ ìˆ¨ê²¨ì ¸ ìˆìŒ) -->
    <audio id="screamSound" src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" preload="auto"></audio>

    <!-- Age Input Screen -->
    <div id="age-screen" class="game-container flex flex-col items-center justify-center p-8">
        <h1 class="text-3xl font-bold mb-4">ëª‡ ì‚´ì¸ì§€ ì•Œë ¤ì¤„ë˜?</h1>
        <input id="age-input" type="number" class="input-box" placeholder="ì—¬ê¸°ì— ë‚˜ì´ë¥¼ ì…ë ¥í•´ ì¤˜">
        <button id="start-button" class="button">ê²Œì„ ì‹œì‘!</button>
        <p id="saved-money" class="text-xl mt-4 hidden">ì €ì¥ëœ ëˆ: $0</p>
    </div>

    <!-- Game Container -->
    <div id="game-screen" class="game-container hidden">
        <h1 class="text-3xl font-bold mb-4">ì¬ë°ŒëŠ” í•´í‚¹ ê²Œì„</h1>
        <p id="wallet" class="text-xl mt-4">ë‚´ ì§€ê°‘: $0</p>
        <p id="status" class="text-lg mt-2">ìƒíƒœ: ì•”í˜¸ ì…ë ¥ ì¤€ë¹„!</p>
        <p id="target-password" class="text-4xl font-bold mt-4">----</p>
        <input id="user-input" type="text" class="input-box w-20" maxlength="1" placeholder="?" autocomplete="off">
        <button id="submit-button" class="button">ì œì¶œ</button>
        <div id="message-box" class="text-sm mt-4"></div>
        <button id="restart-button" class="button hidden">ì²˜ìŒë¶€í„° ë‹¤ì‹œ í•˜ê¸°</button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const codeRainContainer = document.querySelector('.code-rain');
            const ageScreen = document.getElementById('age-screen');
            const ageInput = document.getElementById('age-input');
            const startButton = document.getElementById('start-button');
            const gameScreen = document.getElementById('game-screen');
            const walletElement = document.getElementById('wallet');
            const savedMoneyElement = document.getElementById('saved-money');
            const targetPasswordElement = document.getElementById('target-password');
            const userInput = document.getElementById('user-input');
            const submitButton = document.getElementById('submit-button');
            const statusElement = document.getElementById('status');
            const messageBox = document.getElementById('message-box');
            const screamSound = document.getElementById('screamSound');
            const restartButton = document.getElementById('restart-button');

            // Game variables
            let password = '';
            let currentPassword = '';
            let passwordLength = 4;
            let isGameActive = false;
            let walletBalance = 0;
            let isEasyMode = false;
            let hintTimer = null; // íŒíŠ¸ íƒ€ì´ë¨¸ë¥¼ ì €ì¥í•  ë³€ìˆ˜

            // Matrix effect
            function createCodeRain() {
                const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()_+-=[]{}|;:,.<>/?";
                const numDrops = 150;

                for (let i = 0; i < numDrops; i++) {
                    const drop = document.createElement('div');
                    drop.className = 'matrix-text';
                    drop.style.left = Math.random() * 100 + 'vw';
                    drop.style.top = -100 + 'px';
                    drop.style.fontSize = Math.random() * 20 + 10 + 'px';
                    codeRainContainer.appendChild(drop);

                    let text = '';
                    const len = Math.random() * 20 + 5;
                    for (let j = 0; j < len; j++) {
                        text += chars[Math.floor(Math.random() * chars.length)] + '\n';
                    }
                    drop.textContent = text;

                    // Animation
                    let topPos = -Math.random() * 500;
                    const speed = Math.random() * 2 + 1;
                    const animateDrop = () => {
                        topPos += speed;
                        if (topPos > window.innerHeight) {
                            topPos = -drop.clientHeight;
                            drop.style.left = Math.random() * 100 + 'vw';
                        }
                        drop.style.top = topPos + 'px';
                        requestAnimationFrame(animateDrop);
                    };
                    animateDrop();
                }
            }

            // Save the game's wallet balance and age to local storage
            function saveGame() {
                localStorage.setItem('hackingGameWallet', walletBalance);
            }

            function saveAge(age) {
                const now = new Date().getTime();
                localStorage.setItem('hackingGameAge', age);
                localStorage.setItem('hackingGameAgeTimestamp', now);
            }

            // Load the game's wallet balance
            function loadGame() {
                const savedBalance = localStorage.getItem('hackingGameWallet');
                if (savedBalance !== null) {
                    walletBalance = parseInt(savedBalance);
                }
                walletElement.textContent = `ë‚´ ì§€ê°‘: $${walletBalance}`;
                if (walletBalance > 0) {
                    savedMoneyElement.textContent = `ì €ì¥ëœ ëˆ: $${walletBalance}`;
                    savedMoneyElement.classList.remove('hidden');
                }
            }

            // Generate a random password of a specific length
            function generatePassword(length) {
                const chars = "0123456789";
                let result = '';
                for (let i = 0; i < length; i++) {
                    result += chars.charAt(Math.floor(Math.random() * chars.length));
                }
                return result;
            }

            // Start the game with difficulty based on age
            function startGame(age) {
                if (isGameActive) return;
                isGameActive = true;
                messageBox.textContent = '';
                userInput.value = '';
                userInput.disabled = false;
                submitButton.disabled = false;
                restartButton.classList.add('hidden');

                walletElement.textContent = `ë‚´ ì§€ê°‘: $${walletBalance}`;

                // 9ì‚´ ì´í•˜ëŠ” ì•”í˜¸ê°€ 4ìë¦¬
                if (age <= 9) {
                    passwordLength = 4;
                    isEasyMode = true;
                } else {
                    passwordLength = Math.min(age, 12);
                    isEasyMode = false;
                }

                password = generatePassword(passwordLength);
                currentPassword = password;

                // ê²Œì„ ì‹œì‘ ì‹œ 20ì´ˆ ë™ì•ˆ ì•”í˜¸ ë³´ì—¬ì£¼ê¸°
                targetPasswordElement.textContent = password;
                messageBox.textContent = `ì•”í˜¸ê°€ ${passwordLength}ê°œì•¼! 20ì´ˆ ë™ì•ˆ ì˜ ë´!`;

                // 20ì´ˆ í›„ì— ì•”í˜¸ ê°€ë¦¬ê¸°
                if (hintTimer) clearTimeout(hintTimer);
                hintTimer = setTimeout(() => {
                    hideHint();
                }, 20000);

                userInput.focus();
            }

            // íŒíŠ¸ ê°€ë¦¬ê¸° (íƒ€ì´ë¨¸ê°€ ëë‚˜ê±°ë‚˜ ì²« ë²ˆì§¸ ì…ë ¥ì´ ì„±ê³µí–ˆì„ ë•Œ)
            function hideHint() {
                if (!isGameActive) return;
                targetPasswordElement.textContent = '-'.repeat(password.length);
                messageBox.textContent = `ì•”í˜¸ê°€ ê°€ë ¤ì¡Œì–´! ê¸°ì–µí•´ì„œ ë§ì¶°ë´!`;
                isEasyMode = false; // ì‰¬ìš´ ëª¨ë“œ ë¹„í™œì„±í™”
            }

            // End the game
            function endGame(result, message) {
                isGameActive = false;
                statusElement.textContent = `ìƒíƒœ: ê²Œì„ ì¢…ë£Œ! - ${result}`;
                messageBox.textContent = message;
                userInput.disabled = true;
                submitButton.disabled = true;
                restartButton.classList.remove('hidden'); // Show restart button

                // í•´í‚¹ ì„±ê³µ ì‹œ ì†Œë¦¬ ì¬ìƒ
                if (result === 'ì„±ê³µ') {
                    screamSound.play();
                }

                saveGame(); // Save the wallet balance when the game ends
            }

            // Event listener for the submit button
            submitButton.addEventListener('click', () => {
                if (!isGameActive) return;
                const guess = userInput.value.trim();
                if (guess.length !== 1 || !/^\d$/.test(guess)) {
                    messageBox.textContent = 'ìˆ«ì í•˜ë‚˜ë§Œ ì…ë ¥í•´ ì¤˜.';
                    userInput.value = '';
                    return;
                }

                if (guess === currentPassword.charAt(0)) {
                    // ì²« ë²ˆì§¸ ì„±ê³µì ì¸ ì…ë ¥ ì‹œ íŒíŠ¸ ë°”ë¡œ ê°€ë¦¬ê¸°
                    if (currentPassword.length === password.length) {
                        if (hintTimer) {
                            clearTimeout(hintTimer);
                            hideHint();
                        }
                    }

                    // Correct guess
                    const solvedPart = password.substring(0, password.length - currentPassword.length + 1);
                    const remainingPart = '-'.repeat(currentPassword.length - 1);
                    targetPasswordElement.textContent = solvedPart + remainingPart;
                    messageBox.textContent = 'ë”©ë™ëŒ•! ğŸ‰';
                    currentPassword = currentPassword.substring(1);
                    userInput.value = '';
                    if (currentPassword.length === 0) {
                        // ë” ë§ì€ ëˆì„ ë²Œ ìˆ˜ ìˆê²Œ ë³´ë„ˆìŠ¤ ê¸ˆì•¡ ì¦ê°€
                        const earnedAmount = Math.floor(Math.random() * 150) + 100;
                        walletBalance += earnedAmount;
                        endGame('ì„±ê³µ', `êº… êº…! ğŸ˜± ì™€! í•´í‚¹ ì„±ê³µ! $${earnedAmount}ë¥¼ ì–»ì—ˆì–´! ë‚´ ì§€ê°‘: $${walletBalance} ğŸ‰`);
                    }
                } else {
                    // Wrong guess
                    messageBox.textContent = 'ë•¡! âŒ ë‹¤ì‹œ ì‹œë„í•´ ë´!';
                    userInput.value = '';
                }
                userInput.focus();
            });

            // í‚¤ë³´ë“œ ì—”í„° í‚¤ë¡œ ì œì¶œí•˜ê¸°
            userInput.addEventListener('keypress', (event) => {
                if (event.key === 'Enter') {
                    submitButton.click();
                }
            });

            // "ì²˜ìŒë¶€í„° ë‹¤ì‹œ í•˜ê¸°" ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
            restartButton.addEventListener('click', () => {
                // ì €ì¥ëœ ëª¨ë“  ê²Œì„ ë°ì´í„°ë¥¼ ì‚­ì œí•˜ê³  ì²˜ìŒ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°€ê¸°
                localStorage.removeItem('hackingGameAge');
                localStorage.removeItem('hackingGameAgeTimestamp');
                localStorage.removeItem('hackingGameWallet');
                walletBalance = 0;

                ageScreen.classList.remove('hidden');
                gameScreen.classList.add('hidden');
                ageInput.value = '';
                loadGame(); // UIë¥¼ ì—…ë°ì´íŠ¸í•˜ì—¬ ëˆì´ 0ì¸ ê²ƒì„ ë³´ì—¬ì¤Œ
            });

            // ë‚˜ì´ ì…ë ¥ í›„ ê²Œì„ ì‹œì‘ ë²„íŠ¼
            startButton.addEventListener('click', () => {
                const age = parseInt(ageInput.value);
                if (isNaN(age) || age <= 0) {
                    messageBox.textContent = 'ë‚˜ì´ë¥¼ ì •í™•í•˜ê²Œ ì…ë ¥í•´ ì¤˜.';
                    return;
                }

                saveAge(age);
                ageScreen.classList.add('hidden');
                gameScreen.classList.remove('hidden');
                startGame(age);
            });

            // í˜ì´ì§€ ë¡œë“œ ì‹œ ë‚˜ì´ ë° ê²Œì„ ìƒíƒœ í™•ì¸
            function initGame() {
                loadGame();
                const savedAge = localStorage.getItem('hackingGameAge');
                const savedTimestamp = localStorage.getItem('hackingGameAgeTimestamp');
                const now = new Date().getTime();
                const oneYearInMs = 365 * 24 * 60 * 60 * 1000;

                if (savedAge && savedTimestamp && (now - savedTimestamp < oneYearInMs)) {
                    // 1ë…„ì´ ì§€ë‚˜ì§€ ì•Šì•˜ìœ¼ë©´ ì €ì¥ëœ ë‚˜ì´ì™€ ëˆìœ¼ë¡œ ë°”ë¡œ ì‹œì‘
                    ageScreen.classList.add('hidden');
                    gameScreen.classList.remove('hidden');
                    startGame(parseInt(savedAge));
                } else {
                    // 1ë…„ì´ ì§€ë‚¬ê±°ë‚˜ ë‚˜ì´ê°€ ì €ì¥ë˜ì§€ ì•Šì•˜ìœ¼ë©´ ë‚˜ì´ ì…ë ¥ í™”ë©´ ë³´ì—¬ì¤Œ
                    ageScreen.classList.remove('hidden');
                    gameScreen.classList.add('hidden');
                }
            }

            // Start the code rain effect and load the game on page load
            createCodeRain();
            initGame();
        });
    </script>
</body>
</html>
